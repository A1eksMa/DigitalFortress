# Entry-нода

Entry-нода — это публичный узел первой линии, который принимает клиентские подключения и маскирует VPN-трафик под легитимный HTTPS.

## Роль в архитектуре

```
Клиент → Entry-нода → Core-нода → Интернет
         ^^^^^^^^^^^
         Вы здесь
```

## Характеристики

| Параметр | Значение |
|----------|----------|
| Функция | Приём клиентских подключений |
| Маскировка | Легитимный HTTPS-сайт |
| Жизненный цикл | Недолгоживущая, расходная |
| Компоненты | Nginx + Xray-core + сайт-прикрытие |
| Открытые порты | 22 (SSH), 443 (HTTPS) |

## Принцип работы

```
┌─────────────────────────────────────────────────────────────────┐
│                     NGINX (0.0.0.0:443)                         │
│                                                                  │
│  TLS-терминация + маршрутизация:                                │
│                                                                  │
│  /                          → Сайт-прикрытие                    │
│  /api/v2/xhttp/{random}/    → Xray XHTTP   (127.0.0.1:10001)    │
│  /api/v2/stream/{random}/   → Xray WS      (127.0.0.1:10002)    │
│  /api/v2/rpc/{random}/      → Xray gRPC    (127.0.0.1:10003)    │
│                                                                  │
│  Fallback: неверный запрос → сайт-прикрытие (200 OK)            │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                     XRAY-CORE (только localhost)                │
│                                                                  │
│  Inbound: VLESS + XHTTP/WS/gRPC                                 │
│  Outbound: freedom (этап 1) / Core-нода (этап 2+)               │
└─────────────────────────────────────────────────────────────────┘
```

## Документация по настройке

| Шаг | Документ | Описание |
|-----|----------|----------|
| 1 | [01-hosting.md](./01-hosting.md) | Выбор хостинг-провайдера |
| 2 | [02-server-setup.md](./02-server-setup.md) | Базовая настройка сервера |
| 3 | [03-nginx-setup.md](./03-nginx-setup.md) | Установка Nginx + SSL |
| 4 | [04-cover-site.md](./04-cover-site.md) | Развёртывание сайта-прикрытия |
| 5 | [05-xray-install.md](./05-xray-install.md) | Установка и настройка Xray |
| 6 | [06-xray-clients.md](./06-xray-clients.md) | Настройка клиентских подключений |

## Конкретные инстансы

- [mimimi-pro.md](./instances/mimimi-pro.md) — Entry-нода mimimi.pro (ABLENET, Япония)

## Требования безопасности

- Xray слушает **только на 127.0.0.1** (никогда 0.0.0.0)
- Пути URL должны быть **случайными** (не `/ws/` или `/vless/`)
- Firewall: только порты **22 и 443** открыты
- При неверном запросе — **отдавать сайт**, не ошибку
- User-Agent и заголовки клиента должны быть **браузерными**

## Транспорты

| Приоритет | Транспорт | Описание |
|-----------|-----------|----------|
| 1 | XHTTP | Основной, разбивает на короткие HTTP-запросы |
| 2 | WebSocket | Совместим с CDN, похож на чаты |
| 3 | gRPC | HTTP/2, мультиплексирование |

## Текущий статус

**Entry-нода mimimi.pro:**

| Компонент | Статус |
|-----------|--------|
| Хостинг (ABLENET) | Готово |
| Домен | Готово |
| Nginx + SSL | Готово |
| Сайт-прикрытие | Готово |
| Xray-core | В работе |
